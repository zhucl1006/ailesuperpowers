---
name: aile-subagent-dev
description: 面向团队工作流的子代理开发技能（阶段3）。基于已批准的计划，按任务派发子代理实现，并执行“规格合规→代码质量”双阶段审查，必要时同步 Jira 子任务状态。
---

# Aile：子代理驱动开发（aile-subagent-dev）

## 概述

在团队流程中，本技能用于阶段 3 的任务执行：

- 输入：`docs/plans/{Story-Key}/analysis.md` 中的任务拆解
- 输出：按任务完成代码实现与验证，并通过双阶段审查把关

## 来源原 Skill

- 来源：`skills/subagent-driven-development/SKILL.md`
- 策略：保留原 Skill 作为基线与回退路径，本 Skill 复制改写以加入团队 Gate 与 Jira 同步语义。

## 团队增强点（相对原 Skill）

- Gate 对齐：未通过 G2（PM/QA）审查的计划，不进入实现。
- 任务上下文最小化：子代理只拿“当前任务全文 + 必要上下文”，禁止让子代理通读整份计划（降低上下文膨胀）。
- 双阶段审查标准化：
  1) 规格合规（是否严格按计划与 AC 实现、无多做/少做）
  2) 代码质量（SOLID/KISS/DRY/YAGNI、安全性、可维护性）
- Jira 同步（可选）：任务完成后将对应 Sub-task 流转为 DONE，并回写关键验证结果。

## 何时使用

- 你已经有“已批准”的阶段 2 计划（`analysis.md`）
- 任务相对独立，适合逐个派发并审查
- 你希望留在当前会话进行串行推进（并保持每任务新鲜上下文）

## 执行流程

**开始时声明：**“我正在使用 aile-subagent-dev 技能按计划执行任务。”

1. 读取 `analysis.md`，提取所有任务全文与依赖
2. 建立任务列表（以依赖顺序执行）
3. 对每个任务：
   - 若任务状态为 BLOCKED，先执行“阻塞任务处理”（见下文），仅在解除阻塞后进入实现
   - 派发 implementer 子代理：只给任务全文、相关文件路径、验证命令、约束（必须 TDD）
   - implementer 完成后：自检（是否按计划、是否验证、是否有多做/少做）
   - 派发 spec reviewer：核对“计划/AC/测试”一致性
   - 派发 code quality reviewer：核对质量与安全
   - 有问题则返工并复审，直到通过
4. 所有任务完成后：派发一次全量代码审查（可选），进入交付流程

## 阻塞任务处理

遇到 BLOCKED 状态的任务时：

1. 使用 `jira_get_issue` 读取当前任务的 `blocked-by` Link。
2. 检查被依赖 Issue 的状态：
   - 若依赖 Issue 仍未完成：跳过当前任务，继续执行其他非阻塞任务。
   - 若依赖 Issue 已完成：
     - 读取其 Comment，提取接口契约/事件定义等关键信息。
     - 将契约信息写入当前任务上下文（供 implementer 与 reviewer 使用）。
     - 将当前任务状态从 BLOCKED 流转为 IN PROGRESS。
     - 按本技能流程进入 TDD 开发与后续双阶段审查。

## 危险信号

- 在未通过规格合规审查前进入代码质量审查
- 子代理未运行验证就声称完成
- 任务间并发派发多个实现子代理导致冲突
- 让子代理通读整份计划导致上下文膨胀与偏航
